package com.cdac.tester;

import static com.cdac.utils.DBUtils.*;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;
public class TestPreparedStatement {

	public static void main(String[] args) {

		try(Scanner sc = new Scanner(System.in)) {
			
			String sql ="select * from users where email=? and password = ?";
			//openConnection
			openConnection();
			//get connection
			Connection cn = getConnection();
			// create JDBC Preparedstatement
			/*
			 * Connection i/f method 
			 * public PreparedStatement prepareStatement(String sql) throws SQLException
			 */
				Statement st= cn.prepareStatement(sql);
				// execute the query n get ResultSet - selected rows n columns
				/*
				 * Method of Statement i/f public ResultSet executeQuery(String sql) throws
				 * SQLException
				 */
				try (ResultSet rst = st.executeQuery("select * from users")) {
					// RST - cursor - before the 1st row
					/*
					 * ResultSet Method -  public boolean next() throws SQLException
					 * 
					 */
					/*
					 * id | first_name | last_name | email | password 
					 * | dob | status | role
					 */
					while (rst.next())
						System.out.printf("ID %d Name %s %s Email %s "
								+ "Pwd %s Dob %s Voting Status %b Role %s %n",
								rst.getInt(1),rst.getString(2),rst.getString(3),rst.getString(4),
								rst.getString(5),rst.getDate(6),rst.getBoolean(7),rst.getString(8));
				} //JVM - rst.close();
				closeConnection();
			} 
		catch (Exception e) {
				e.printStackTrace();
			}
		
	}

}



